<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>
        {% block title%}{{title}}{% endblock %}
    </title>
    <meta name="author" content="Datopian">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="/static/stylesheets/app.css">
    <link rel="stylesheet" href="/static/stylesheets/montreal.css">
    {% if dataset %}
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.3/leaflet.css">
    {% endif %}
</head>
<body class="{% block bodyclass %}{{bodyclass}}{% endblock %} " id="montreal">
<div id="page" class="page sm:mx-6 mt-6 ">
    <!-- Page header -->
    <header class="flex  mb-4">
        
        <div class="w-1/3">
            
        </div>
        
        <label tabindex="0" for="hb__trigger" class="nav-trigger sm:hidden" type="button" aria-label="Menu"
               aria-controls="navigation" aria-expanded="false">
            <div class="hb">
            <span class="hb__box">
                <span class="hb__inner"></span>
            </span>
                <span class="hb__label">{{__('Menu')}}</span>
            </div>
        </label>
        <button id="nav-toggle"
                class="absolute top-0 right-0 p-gutter outline-none focus:outline-none focus:text-secondary lg:hidden invisible">
            <svg class="w-8 h-8 fill-current">
                <use xlink:href="#menu"/>
            </svg>
        </button>
        <div class="w-1/3 header-image content-center">
            <a class="logo" href="/">
                <img src="/static/img/logo.svg" alt="City of Montreal" title="City of Montreal"
                                          height="40px"/></a>
        </div>
            <nav class="">
                <div class="nav-collapse invisible lg:visible">
                    <ul class="flex text-primary font-bold absolute right-0 mr-4">
                        <li class="mr-3">
                            <a class="hover:text-secondary" href="/news">{{__('News')}}</a>
                        </li>
                        <li class="mr-3">
                            <a class="hover:text-secondary" href="/dash">Dashboard</a>
                        </li>
                        <li class="mr-3">
                            <a class="hover:text-secondary" href="/collections">{{__('Collections')}}</a>
                        </li>
                        <li class="mr-3">
                            <a class="hover:text-secondary" href="/search">{{__('Data')}}</a>
                        </li>
                        <li class="mr-3">
                            <a class="hover:text-secondary" href="/about">About</a>
                        </li>
                    
                    </ul>
                </div>
            </nav>
    </header>
    <!-- End of page header -->

    {% block content %}{{content}}{% endblock %}
</div>

<!-- Footer -->
<footer class="site-footer bg-gray-ink text-white-74 mt-10 py-gutter text-sm">
    <div class="container">
        <div class="flex">
            <div class="w-1/2">
                <a class="block w-24 m-4 hover:text-white" href="https://ckan.org/" ml-24>
                    <span>Powered by</span>
                    {% include "./partials/ckan-logo.svg" %}
                </a>
            </div>
            <div class="w-1/2">
                <ul class="language-switcher text-right">
                    <li onclick="languageSwitcher(this)"><a data-language="en" data-language-name="English"
                                                            href="#">EN</a></li>
                    <li onclick="languageSwitcher(this)"><a data-language="fr" data-language-name="French"
                                                            href="#">FR</a></li>
                </ul>
            </div>
        </div>
    </div>
    </div>
</footer>
<!-- end of footer -->
</div>

<div class="hidden">
    {% include "./partials/symbol/svg/sprite.symbol.svg" %}
</div>

<!-- <script src="/static/js/scripts.js"></script> -->
{% block scripts %}{% endblock %}
<script>
    function languageSwitcher(el) {
        let lang = el.getElementsByTagName('a')[0].getAttribute('data-language');
        console.log('lang', lang)
        document.cookie = "defaultLocale=" + lang;
        location.reload();
    }
</script>
<script>
    // nav
    var navToggle = document.getElementById("nav-toggle");
    var navTarget = navToggle.nextElementSibling;

    // show toggle
    navToggle.classList.remove("invisible");

    // hide nav
    navTarget.setAttribute("data-expanded", "false");

    // toggle nav
    navToggle.onclick = function () {
        let expanded = navToggle.getAttribute('aria-expanded') === 'true' || false;
        navToggle.setAttribute('aria-expanded', !expanded);
        navTarget.setAttribute("data-expanded", !expanded);
    }


    // search
    // replace link with a button
    var searchLink = document.getElementById("search-link");
    var searchButton = document.createElement("button");
    var searchForm = document.getElementById("header-search");
    searchButton.setAttribute("class", "main-nav_search-toggle");
    searchButton.setAttribute("aria-expanded", "false");

    while (searchLink.childNodes.length > 0) {
        searchButton.appendChild(searchLink.childNodes[0]);
    }

    searchLink.replaceWith(searchButton);

    // button toggles form
    searchButton.onclick = function () {
        let expanded = searchButton.getAttribute('aria-expanded') === 'true' || false;
        searchButton.setAttribute('aria-expanded', !expanded);
        searchForm.setAttribute("data-expanded", !expanded);

        if (!expanded) {
            document.getElementById("header-search-input").focus();
        }
    }

</script>

</body>
</html>
