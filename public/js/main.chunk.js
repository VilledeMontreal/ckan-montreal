(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{240:function(e,t,a){},487:function(e,t){},497:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataView=function(e){if(e.loading)return r.default.createElement("div",{className:"App"},r.default.createElement("div",{className:"container m-24"},r.default.createElement(u.default,{type:"Grid",color:"#D3D3D3",height:"50",width:"50"})));var t=e.datapackage.views?e.datapackage.views.length:0;if(0===t)return r.default.createElement("div",{className:"App"},"No views available");for(var a=function(t){var a=e.datapackage.views[t];if(!a.resources[0]._values&&a.resources[0].data&&(a.resources[0]._values=a.resources[0].data),"table"===a.specType&&a.resources[0]._values){var u=(0,s.handsOnTableToHandsOnTable)(a),f=u.data,p=function(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}(u,["data"]);return{v:r.default.createElement("div",{className:"App"},r.default.createElement("div",{className:"container m-24"},r.default.createElement(o.default,{data:f,options:p,ref:function(e){window["table".concat(a.id)]=e}})))}}if("map"===a.specType&&a.resources[0]._values)return{v:r.default.createElement("div",{className:"App"},r.default.createElement("div",{className:"container m-24"},r.default.createElement(i.default,{data:a.resources[0]._values})))};if("tabularmap"===a.specType&&a.resources[0]._values){var m;try{return m=(0,d.default)(a),{v:r.default.createElement("div",{className:"App"},r.default.createElement("div",{className:"container m-24"},r.default.createElement(i.default,{data:m})))}}catch(y){return{v:r.default.createElement("div",{className:y})}}}else{if("document"===a.specType)return{v:r.default.createElement("div",{className:"App"},r.default.createElement("div",{className:"container m-24"},r.default.createElement(c.default,{file:a.resources[0].path})))};var v;if("simple"===a.specType)try{if(v=(0,s.simpleToPlotly)(a))return{v:r.default.createElement("div",{className:"App"},r.default.createElement("div",{className:"container m-24"},r.default.createElement(l.default,{spec:v})))}}catch(y){return{v:r.default.createElement("div",{className:y})}}else if("vega"===a.specType){var g;try{return g=(0,s.vegaToVega)(a),{v:r.default.createElement(n.default,{spec:g})}}catch(y){return{v:r.default.createElement("div",{className:y})}}}else if(a.resources[0].unavailable)return{v:r.default.createElement("div",{className:"App"},r.default.createElement("div",{className:"container m-24"},r.default.createElement("p",null,"Data view unavailable."),r.default.createElement("a",{href:a.resources[0].path,className:"text-primary font-bold"},"Download the data.")))}}},f=0;f<t;f++){var m=a(f);if("object"===p(m))return m.v}};var r=f(a(22)),n=f(a(559));a(567),a(568);var o=f(a(569)),i=f(a(606)),c=f(a(617)),l=f(a(619)),s=a(622),u=f(a(626)),d=f(a(648));function f(e){return e&&e.__esModule?e:{default:e}}function p(e){return(p="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},507:function(e,t,a){e.exports=a(999)},562:function(e,t){},563:function(e,t){},567:function(e,t,a){},568:function(e,t,a){},569:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n=(r=a(22))&&r.__esModule?r:{default:r},o=a(997),i=a(601);function c(e){return(c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}a(605);var p=function(e){function t(e){var a,r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,n=s(t).call(this,e),a=!n||"object"!==c(n)&&"function"!==typeof n?u(r):n,f(u(a),"updateData",function(e){a.setState({data:e})}),f(u(a),"addSettings",function(e){a.setState({settings:Object.assign({},a.state.settings,e)})}),f(u(a),"downloadJson",function(){var e=a.state.data;if(e&&Array.isArray(e[0])){var t=a.state.settings.colHeaders;e=e.map(function(e){var a={};return t.forEach(function(t,r){a[t]=e[r]}),a})}e=JSON.stringify(e,null,2);var r=new Blob([e],{type:"application/json"}),n=document.createElement("a");n.href=URL.createObjectURL(r),n.download="".concat(a.state.settings.viewTitle,".json"),document.body.appendChild(n),n.click(),document.body.removeChild(n)}),a.state={data:a.props.data,settings:Object.assign({},a.props.options,{licenseKey:"non-commercial-and-evaluation"})},a}var a,r,p;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,n.default.Component),a=t,(r=[{key:"render",value:function(){return n.default.createElement("div",null,n.default.createElement("div",{className:"downloadables hidden"},n.default.createElement("span",null,"Download preview data:"),n.default.createElement(i.CSVLink,{data:this.state.data,headers:this.state.settings.colHeaders,filename:"".concat(this.state.settings.viewTitle,".csv"),className:"btn btn-primary",target:"_blank"},"CSV (Excel)"),n.default.createElement("button",{onClick:this.downloadJson,className:"btn btn-primary"},"JSON")),n.default.createElement(o.HotTable,{data:this.state.data,width:"100%",height:"300",settings:this.state.settings}),this.state.settings.totalrowcount&&n.default.createElement("div",{align:"right"},"Showing rows 1-",this.state.settings.rowcount," out of ",this.state.settings.totalrowcount))}}])&&l(a.prototype,r),p&&l(a,p),t}();t.default=p},605:function(e,t,a){},606:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=n.default.geoJSON(e.data).getBounds();if(!e.data.features||e.data.features.length<2||Object({NODE_ENV:"production",PUBLIC_URL:""}).JEST_WORKER_ID){var a=t.getCenter();return a=[a.lat,a.lng],r.default.createElement(o.Map,{center:a,zoom:10,style:{width:"100%",height:450}},r.default.createElement(o.TileLayer,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),r.default.createElement(o.GeoJSON,{data:e.data,onEachFeature:c}))}return r.default.createElement(o.Map,{bounds:t,style:{width:"100%",height:450}},r.default.createElement(o.TileLayer,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),r.default.createElement(o.GeoJSON,{data:e.data,onEachFeature:c}))};var r=i(a(22)),n=i(a(27)),o=a(998);function i(e){return e&&e.__esModule?e:{default:e}}function c(e,t){e.properties&&e.properties.name&&t.bindPopup(e.properties.name)}a(613),delete n.default.Icon.Default.prototype._getIconUrl,n.default.Icon.Default.mergeOptions({iconRetinaUrl:a(614),iconUrl:a(615),shadowUrl:a(616)})},613:function(e,t,a){},617:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;var t=o();if(t&&t.has(e))return t.get(e);var a={};if(null!=e){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var i=r?Object.getOwnPropertyDescriptor(e,n):null;i&&(i.get||i.set)?Object.defineProperty(a,n,i):a[n]=e[n]}}a.default=e,t&&t.set(e,a);return a}(a(22)),n=a(618);function o(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(l){n=!0,o=l}finally{try{r||null==c.return||c.return()}finally{if(n)throw o}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var c=function(e){var t=i((0,r.useState)(1),2),a=t[0],o=t[1],c=i((0,r.useState)(null),2),l=c[0],s=c[1],u=(0,r.useRef)(null),d=i((0,n.usePdf)({file:e.file,page:a,canvasEl:u}),2),f=d[0],p=d[1];return(0,r.useEffect)(function(){s(p)},[p]),r.default.createElement("div",null,f&&r.default.createElement("span",null,"Loading..."),r.default.createElement("canvas",{ref:u}),function(e,t){if(!t)return null;var a=r.default.createElement("li",{className:"previous",onClick:function(){return o(e-1)}},r.default.createElement("a",{href:"#previous"},r.default.createElement("i",{className:"arrow-left"})," Previous"));1===e&&(a=r.default.createElement("li",{className:"previous disabled"},r.default.createElement("a",{href:"#previous"},r.default.createElement("i",{className:"arrow-left"})," Previous")));var n=r.default.createElement("li",{className:"next",onClick:function(){return o(e+1)}},r.default.createElement("a",{href:"#next"},"Next ",r.default.createElement("i",{className:"arrow-right"})));return e===t&&(n=r.default.createElement("li",{className:"next disabled"},r.default.createElement("a",{href:"#next"},"Next ",r.default.createElement("i",{className:"arrow-right"})))),r.default.createElement("nav",null,r.default.createElement("ul",{className:"pager"},a,n))}(a,l))};t.default=c},619:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(0,o.default)(n.default);return r.default.createElement(t,{data:e.spec.data,layout:e.spec.layout})};var r=i(a(22)),n=i(a(620)),o=i(a(621));function i(e){return e&&e.__esModule?e:{default:e}}},648:function(module,exports,__webpack_require__){"use strict";function getLonLat(e,t){return t.map(function(t,a){var r=e[t].toString().match(/[-+]?[0-9]*\.?[0-9]*/);if(r){var n=r[0].toString().match(/^[-+]?([1-8]?\d(\.\d+)?|90(\.0+)?)$|^[-+]?(180(\.0+)?|((1[0-7]\d)|([1-9]?\d))(\.\d+))$/);if(n){if(isNaN(n[0]))throw"Invalid lon/lat values";return n[0]}throw"Invalid lon/lat values"}throw"Invalid lon/lat values"})}function tableToGeoData(view){view.spec=view.spec||{},view.resources[0].schema=view.resources[0].schema||{fields:[]};var geoData={type:"FeatureCollection",features:[]};if(view.resources[0]._values&&view.resources[0]._values.forEach(function(data){var feature,geometryFieldNames=["geojson","geom","the_geom","geometry","spatial","location","geo","lonlat"],geometryField=view.resources[0].schema.fields.find(function(e){return geometryFieldNames.includes(e.name.toLowerCase())});if(geometryField)feature=getGeometryFromRecord(data[geometryField.name]);else{if(feature={type:"Feature",geometry:{type:"Point",coordinates:[]},properties:{name:""}},view.spec.lonField&&view.spec.latField)try{feature.geometry.coordinates=getLonLat(data,[view.spec.lonField,view.spec.latField])}catch(e){return void console.warn(e)}else{var geopointField=view.resources[0].schema.fields.find(function(e){return"geopoint"===e.type});if(geopointField)"default"===geopointField.format?feature.geometry.coordinates=data[geopointField.name].split(",").map(function(e){return e.trim()}):"array"===geopointField.format?feature.geometry.coordinates=data[geopointField.name]:"object"===geopointField.format&&(feature.geometry.coordinates=[data[geopointField.name].lon,data[geopointField.name].lat]);else{var latitudeFieldNames=["lat","latitude"],longitudeFieldNames=["lon","longitude"],latField=view.resources[0].schema.fields.find(function(e){return latitudeFieldNames.includes(e.name.toLowerCase())}),lonField=view.resources[0].schema.fields.find(function(e){return longitudeFieldNames.includes(e.name.toLowerCase())});if(!latField||!lonField)throw"No geo data found";feature.geometry.coordinates=[data[lonField.name],data[latField.name]]}}view.spec.infobox&&(feature.properties.name=eval("`"+view.spec.infobox+"`"))}geoData.features.push(feature)}),0===geoData.features.length)throw"No geodata on resource";return geoData}function getGeometryFromRecord(e){if("string"===typeof e)try{e=JSON.parse(e)}catch(n){}if("string"===typeof e){var t=(e=e.replace("(","").replace(")","")).split(","),a=parseCoordinateString(t[0]),r=parseCoordinateString(t[1]);return isNaN(r)||isNaN(parseFloat(a))?null:{type:"Point",coordinates:[r,a]}}return e&&"Array"===e.constructor.name?{type:"Point",coordinates:[e[0],e[1]]}:e&&e.lat?{type:"Point",coordinates:[e.lon||e.lng,e.lat]}:e}function parseCoordinateString(e){if("string"!=typeof e)return parseFloat(e);var t,a=e.split(/[^-?\.\d\w]+/),r=0,n=0,o=[1,60,3600];for(t=0;t<a.length;++t)isNaN(parseFloat(a[t]))||(r+=parseFloat(a[t])/o[n],n+=1);return e.match(/[SW]/)&&(r*=-1),r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=tableToGeoData;exports.default=_default},683:function(e,t){},685:function(e,t){},717:function(e,t){},718:function(e,t){},902:function(e,t,a){var r={"./geojson.json":466,"./table-schema.json":903,"./topojson.json":467};function n(e){var t=o(e);return a(t)}function o(e){if(!a.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}n.keys=function(){return Object.keys(r)},n.resolve=o,e.exports=n,n.id=902},987:function(e,t){},988:function(e,t){},992:function(e,t){},993:function(e,t){},999:function(e,t,a){"use strict";a.r(t);var r=a(488),n=a(11),o=a.n(n),i=a(133),c=a.n(i),l=(a(240),a(234)),s=a(146),u=a(490),d=a(491),f=function(e){var t=p(e);return t.resources&&t.resources.forEach(function(e){delete e.data,delete e._values}),t.views&&t.views.forEach(function(e){e.resources&&e.resources.forEach(function(e){delete e.data,delete e._values})}),t},p=function(e){return JSON.parse(JSON.stringify(e))},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"DATA_VIEW_CHART_BUILDER_ACTION":var a=p(e);return a=a.map(function(e){return"simple"===e.datapackage.views[0].specType&&(e.datapackage.views[0]=t.payload),e}),Object.assign(p(e),a);case"DATA_VIEW_MAP_BUILDER_ACTION":var r=p(e);return r=r.map(function(e){return"tabularmap"===e.datapackage.views[0].specType&&(e.datapackage.views[0]=t.payload),e}),Object.assign(p(e),r);case"SELECT_TAB":case"FETCH_DATA_BEGIN":case"FETCH_DATA_SUCCESS":case"FETCH_DATA_FAILURE":return t.payload.widgets;default:return e}},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"DATAPACKAGE_LOAD":return t.payload.datapackage;default:return e}},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch((arguments.length>1?arguments[1]:void 0).type){case"FILTER_UI_ACTION":default:return e}},y=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&arguments[1];var e=arguments.length>2?arguments[2]:void 0;try{var t=p(e);delete t.serializedState;var a=f(t.datapackage),r=t.widgets.map(function(e){return e.datapackage=f(e.datapackage),e.loading=!1,e});return JSON.stringify(Object.assign(t,{datapackage:a,widgets:r}))}catch(n){return console.warn(n),{}}},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return{widgets:m(e.widgets,t),datapackage:v(e.datapackage,t),datastoreFilters:g(e.datastoreFilters,t),serializedState:y(e.serializedState,t,e)}},h={datastoreFilters:{},datapackage:{},widgets:[],serializedState:{}};function w(e){return Object(s.createStore)(b,Object.assign({},h,e),Object(u.composeWithDevTools)(Object(s.applyMiddleware)(d.a)))}var E=a(227),O=a(492),N=a(496),k=a.n(N),S=a(497),_=function(e){var t=e.datapackage.views;return o.a.createElement(k.a,{loaded:!e.loading,style:{position:"relative"}},o.a.createElement("div",null,t.map(function(e){return o.a.createElement(S.DataView,{key:Math.random(),datapackage:{views:[e]}})})))},j=["archiver","schema","shareLink","iframeText"],x=function(e){var t=function(e){if(e.length<=1500)return e;var t=JSON.parse(e);return t.datapackage.resources.forEach(function(e){for(var t in j)e[j[t]]&&delete e[j[t]]}),JSON.stringify(t)}(e.serializedState),a="localhost:4000/data-explorer?explorer=".concat(t),r='<iframe src="localhost:4000/data-explorer?explorer='.concat(t,'" />'),n=a.length<2e3,i=function(e){var t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style={position:"absolute",left:"-9999px"},document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)};return o.a.createElement("div",null,n&&o.a.createElement("div",{className:"dx-share-container"},o.a.createElement("div",{className:"m-4"},o.a.createElement("input",{id:"share-link",className:"border-solid border-4 border-gray-600 w-1/2 px-2",value:a}),o.a.createElement("a",{href:"#/",id:"copy-share-link",className:"m-4",onClick:function(){i(a)}},o.a.createElement("i",null,"copy share link"))),o.a.createElement("div",{className:"m-4"},o.a.createElement("input",{id:"embed",className:"border-solid border-4 border-gray-600 px-2 w-1/2",value:r}),o.a.createElement("a",{href:"#/",id:"copy-share-link",className:"m-4",onClick:function(){i(r)}},o.a.createElement("i",null,"copy embed text")))),!n&&o.a.createElement("p",null,"No share link available"))},A=a(504),T=a(505),F=a(238),P=a(47),C=a.n(P),D=a(149),J=a(324),I=a(422);function L(e){try{return JSON.parse(e)}catch(t){return e}}var M=function(){var e=Object(D.a)(C.a.mark(function e(t){var a,r,n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=L(t),r=["csv","tsv","dsv","xls","xlsx"],e.prev=2,e.next=5,J.Dataset.load(a);case 5:return n=e.sent,e.next=8,Promise.all(n.resources.map(function(){var e=Object(D.a)(C.a.mark(function e(t){var a,n,o,i,c,l,s,u;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("FileInline"!==t.displayName){e.next=4;break}return e.abrupt("return");case 4:if(!t.descriptor.path||!t.descriptor.path.includes("datastore_search")){e.next=24;break}return e.next=7,fetch(t.descriptor.path);case 7:if((a=e.sent).ok){e.next=11;break}return t.descriptor.unavailable=!0,e.abrupt("return");case 11:return e.next=13,a.json();case 13:return n=e.sent,t.descriptor.data=n.result.records,t.descriptor.path.includes("datastore_search_sql")?t.descriptor.totalrowcount=n.result.records[0]?n.result.records[0].count:void 0:t.descriptor.totalrowcount=n.result.total,o=Object(J.open)({data:t.descriptor.data.map(Object.values),format:"csv"}),i=Object.keys(t.descriptor.data[0]),o.descriptor.data=[i].concat(o.descriptor.data),e.next=21,o.addSchema();case 21:t.descriptor.schema=o.descriptor.schema,e.next=67;break;case 24:if("FileRemote"!==t.displayName||!r.includes(t.descriptor.format)){e.next=43;break}return e.prev=25,e.next=28,t.rows({size:100,keyed:!0});case 28:return c=e.sent,e.next=31,I(c);case 31:return(l=e.sent).length>0?t.descriptor.data=l:t.descriptor.unavailable=!0,e.next=35,t.addSchema();case 35:e.next=41;break;case 37:e.prev=37,e.t0=e.catch(25),console.warn(e.t0),t.descriptor.unavailable=!0;case 41:e.next=67;break;case 43:if(!t.descriptor.format.toLowerCase().includes("json")){e.next=62;break}return e.next=46,fetch(t.descriptor.path);case 46:if((s=e.sent).ok){e.next=50;break}return t.descriptor.unavailable=!0,e.abrupt("return");case 50:return e.next=52,s.json();case 52:if(u=e.sent,!["Feature","FeatureCollection","Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","GeometryCollection"].includes(u.type)){e.next=58;break}t.descriptor.data=u,e.next=60;break;case 58:return t.descriptor.unavailable=!0,e.abrupt("return");case 60:e.next=67;break;case 62:if("pdf"!==t.descriptor.format.toLowerCase()){e.next=66;break}return e.abrupt("return");case 66:t.descriptor.unavailable=!0;case 67:case"end":return e.stop()}},e,null,[[25,37]])}));return function(t){return e.apply(this,arguments)}}()));case 8:return e.abrupt("return",n.descriptor);case 11:return e.prev=11,e.t0=e.catch(2),console.warn("Failed to load a Dataset from provided datapackage id\n"+e.t0),e.abrupt("return",a);case 15:case"end":return e.stop()}},e,null,[[2,11]])}));return function(t){return e.apply(this,arguments)}}(),B=a(325);function U(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?U(a,!0).forEach(function(t){Object(E.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):U(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var V=function(e){return{type:"SELECT_TAB",payload:R({},e)}},G=function(e){return{type:"DATAPACKAGE_LOAD",payload:R({},e)}},z=function(e){return{type:"FETCH_DATA_BEGIN",payload:R({},e)}},H=function(e){return{type:"FETCH_DATA_SUCCESS",payload:R({},e)}};function W(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}var K=Object(l.b)(function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?W(a,!0).forEach(function(t){Object(E.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):W(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},e)},function(e){return{filterUIAction:function(t){return e(function(e){return function(){var t=Object(D.a)(C.a.mark(function t(a,r){var n,o,i,c,l,s;return C.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=JSON.parse(JSON.stringify(r().datapackage)),o=JSON.parse(JSON.stringify(e)),(i=Object.assign(n,{resources:[o]})).resources[0].datastore_active&&delete i.resources[0].data,a(G({datapackage:i})),c=JSON.parse(JSON.stringify(r().widgets)).map(function(e){return e.loading=!0,e}),a(z({widgets:c})),n=JSON.parse(JSON.stringify(r().datapackage)),t.next=10,M(n);case 10:l=t.sent,a(G({datapackage:l})),s=JSON.parse(JSON.stringify(r().widgets)).map(function(e){return e.datapackage.views=e.datapackage.views.map(function(e){return Object(B.compileView)(e,l)}),e.loading=!1,e}),a(H({widgets:s}));case 14:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}()}(t))},fetchDataAction:function(t){return e(function(e){return function(){var t=Object(D.a)(C.a.mark(function t(a){var r,n,o,i;return C.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=JSON.parse(JSON.stringify(e.widgets)).map(function(e){return e.loading=!0,e}),a(z({widgets:r})),n=JSON.parse(JSON.stringify(e.datapackage)),t.next=5,M(n);case 5:o=t.sent,a(G({datapackage:o})),i=JSON.parse(JSON.stringify(e.widgets)).map(function(e){return e.datapackage.views=e.datapackage.views.map(function(e){return Object(B.compileView)(e,o)}),e}),a(H({widgets:i}));case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}(t))},dataViewBuilderAction:function(t){return e(function(e){return function(t){var a;"simple"===e.specType?a="DATA_VIEW_CHART_BUILDER_ACTION":"tabularmap"===e.specType&&(a="DATA_VIEW_MAP_BUILDER_ACTION"),t({type:a,payload:e})}}(t))},selectTabAction:function(t){return e(function(e){return function(t,a){var r=JSON.parse(JSON.stringify(a().widgets));r.forEach(function(t,a){r[a].active=!1,t.name===e&&(r[a].active=!0)}),t(V({widgets:r}))}}(t))}}})(function(e){Object(n.useEffect)(function(){var t={datapackage:e.datapackage,widgets:e.widgets};e.fetchDataAction(t)},[]);var t,a=e.widgets.find(function(e){return e.active}),r=a?a.name:e.widgets[0].name,i=e.widgets.map(function(e){return o.a.createElement(F.TabLink,{to:e.name,className:"mr-4"},e.name)}),c=e.widgets.map(function(t){return o.a.createElement(F.TabContent,{for:t.name},o.a.createElement("div",{className:"container flex py-6"},o.a.createElement("div",{className:"w-3/4 py-3 mr-4"},o.a.createElement(_,t)),o.a.createElement("div",{className:"w-1/4"},o.a.createElement("div",{className:"w-full"},o.a.createElement("div",{className:"p-4 mr-4"},"simple"===t.datapackage.views[0].specType?o.a.createElement(A.ChartBuilder,{view:t.datapackage.views[0],dataViewBuilderAction:e.dataViewBuilderAction}):"","tabularmap"===t.datapackage.views[0].specType?o.a.createElement(T.MapBuilder,{view:t.datapackage.views[0],dataViewBuilderAction:e.dataViewBuilderAction}):"")))))});return o.a.createElement("div",{className:"ml-6"},o.a.createElement("div",{className:"container py-4"},o.a.createElement("div",{className:"datastore-query-builder"},e.datapackage.resources[0].datastore_active?o.a.createElement(O.QueryBuilder,{resource:(t=e.datapackage,t?t.resources[0]:{}),filterBuilderAction:e.filterUIAction}):"")),o.a.createElement(F.Tabs,{renderActiveTabContentOnly:!0,handleSelect:function(t){e.selectTabAction(t)},selectedTab:r},i,c),o.a.createElement(x,{serializedState:e.serializedState}))}),q=function(e){var t,a;if("string"===typeof e.datapackage)try{t=JSON.parse(e.datapackage)}catch(n){t={},console.warn("Invalid datapackage",n)}else"object"===typeof e.datapackage&&(t=e.datapackage);try{a=JSON.parse(JSON.stringify(t.views)),delete t.views}catch(i){console.log("No views set on datapackage")}var r=e.widgets?e.widgets:function(e){var t={table:"Table",tabularmap:"Map",map:"Map",simple:"Chart"};return e.map(function(e,a){return{active:0===a,name:t[e.specType],datapackage:{views:[e]}}})}(a);return o.a.createElement(l.a,{store:w({widgets:r,datapackage:t})},o.a.createElement(K,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var $=document.getElementsByClassName("data-explorer"),Q=!0,X=!1,Y=void 0;try{for(var Z,ee=$[Symbol.iterator]();!(Q=(Z=ee.next()).done);Q=!0){var te=Z.value;try{var ae=JSON.parse(te.getAttribute("data-datapackage")),re=ae.datapackage,ne=Object(r.a)(ae,["datapackage"]);c.a.render(o.a.createElement(q,Object.assign({datapackage:re},ne)),document.getElementById(te.id))}catch(oe){console.warn("Failed to render data-explorer",oe)}}}catch(ie){X=!0,Y=ie}finally{try{Q||null==ee.return||ee.return()}finally{if(X)throw Y}}"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[507,1,2]]]);
//# sourceMappingURL=main.e50c2f95.chunk.js.map